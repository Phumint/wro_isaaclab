==================== DIRECTORY HIERARCHY ====================
.
./gather.sh
./my_robot_controller
./my_robot_controller/setup.cfg
./my_robot_controller/my_robot_controller
./my_robot_controller/my_robot_controller/__init__.py
./my_robot_controller/my_robot_controller/ros2_policy_controller.py
./my_robot_controller/my_robot_controller/__pycache__
./my_robot_controller/my_robot_controller/__pycache__/__init__.cpython-310.pyc
./my_robot_controller/my_robot_controller/__pycache__/ros2_policy_controller.cpython-310.pyc
./my_robot_controller/setup.py
./my_robot_controller/test
./my_robot_controller/test/test_pep257.py
./my_robot_controller/test/test_copyright.py
./my_robot_controller/test/test_flake8.py
./my_robot_controller/package.xml
./my_robot_controller/scripts
./my_robot_controller/scripts/my_robot_policy.onnx
./my_robot_controller/resource
./my_robot_controller/resource/my_robot_controller
./my_robot_gazebo
./my_robot_gazebo/CMakeLists.txt
./my_robot_gazebo/config
./my_robot_gazebo/config/robot_controllers.yaml
./my_robot_gazebo/urdf
./my_robot_gazebo/urdf/my_robot2.urdf
./my_robot_gazebo/urdf/materials.xacro
./my_robot_gazebo/urdf/bicycle_bot.urdf.xacro
./my_robot_gazebo/urdf/wheel.xacro
./my_robot_gazebo/urdf/sensors.xacro
./my_robot_gazebo/urdf/inertials.xacro
./my_robot_gazebo/urdf/steer_bot.urdf.xacro
./my_robot_gazebo/launch
./my_robot_gazebo/launch/my_robot_gazebo.launch.py
./my_robot_gazebo/worlds
./my_robot_gazebo/worlds/my_robot.sdf
./my_robot_gazebo/package.xml
./codebase_snapshot.txt

==================== FILE CONTENTS ====================
-------------------- FILE: ./gather.sh --------------------
#!/bin/sh

# This script first lists the entire directory hierarchy and then
# concatenates the contents of all files into a single file.

# The name of the output file.
OUTPUT_FILE="codebase_snapshot.txt"

# Clear the output file if it already exists to prevent appending.
> "$OUTPUT_FILE"

# --- Section 1: Directory Hierarchy ---
# Find all files and directories in the current directory and list them.
# The output is redirected (>>) into the specified output file.
echo "==================== DIRECTORY HIERARCHY ====================" >> "$OUTPUT_FILE"
find . >> "$OUTPUT_FILE"
echo "" >> "$OUTPUT_FILE"

# --- Section 2: File Contents ---
# Find all regular files (-type f) in the current directory (.) and
# its subdirectories.
# Use 'while read -r' to process each file path safely.
# For each file, a separator and the file path are added before its content.
echo "==================== FILE CONTENTS ====================" >> "$OUTPUT_FILE"
find . -type f | while read -r file; do
    echo "-------------------- FILE: $file --------------------" >> "$OUTPUT_FILE"
    cat "$file" >> "$OUTPUT_FILE"
    echo "" >> "$OUTPUT_FILE" # Add a newline for separation
done

echo "Successfully gathered all files and directory hierarchy into $OUTPUT_FILE"

-------------------- FILE: ./my_robot_controller/setup.cfg --------------------
[develop]
script_dir=$base/lib/my_robot_controller
[install]
install_scripts=$base/lib/my_robot_controller

-------------------- FILE: ./my_robot_controller/my_robot_controller/__init__.py --------------------

-------------------- FILE: ./my_robot_controller/my_robot_controller/ros2_policy_controller.py --------------------
# Import necessary ROS2 and Python libraries
import rclpy
from rclpy.node import Node
# The change here is to import Float64 instead of Twist
from std_msgs.msg import Float64
from nav_msgs.msg import Odometry
from tf_transformations import euler_from_quaternion
import onnxruntime as ort
import numpy as np
import math
# Import ament_index_python to find the path to the ONNX file
from ament_index_python.packages import get_package_share_directory
import os

class PolicyControllerNode(Node):
    """
    ROS2 node that controls a differential drive and Ackermann steering robot
    using a pre-trained ONNX policy.
    """

    def __init__(self):
        super().__init__('policy_controller_node')
        self.get_logger().info('Policy Controller Node Initialized.')

        # --- Parameters (Update these to match your robot and environment) ---
        # Get the path to the package's shared directory
        package_share_directory = get_package_share_directory('my_robot_controller')
        # Correctly construct the full path to the ONNX policy file
        self.policy_path = os.path.join(package_share_directory, 'scripts', 'my_robot_policy.onnx')

        # --- Robot Physical Parameters (UPDATED from wro_env_square.py) ---
        self.WHEEL_RADIUS = 0.034    # Wheel radius in meters
        self.TRACK_WIDTH = 0.09      # Distance between the two rear wheels in meters (y-axis)
        self.WHEEL_BASE = 0.1425     # Distance between the front and rear axles in meters (x-axis)
        
        # --- ROS Topics (Update these to match your Gazebo setup) ---
        # Topic to subscribe to for robot pose and velocity.
        self.odom_topic = '/odom'
        
        # Topics to publish for Ackermann steering
        # We're changing the topics to match a standard ackermann_steering_controller setup.
        self.rear_wheel_topic = '/steer_bot/rear_wheel_controller/commands'
        self.steer_topic = '/steer_bot/steer_controller/commands'

        # --- ROS2 Setup ---
        # Publishers
        # We're now publishing two separate Float64 messages.
        self.rear_wheel_publisher = self.create_publisher(Float64, self.rear_wheel_topic, 10)
        self.steer_publisher = self.create_publisher(Float64, self.steer_topic, 10)

        # Subscribers
        self.odom_subscriber = self.create_subscription(
            Odometry,
            self.odom_topic,
            self.odom_callback,
            10)

        # Timer to run the control loop at a fixed rate (e.g., 20 Hz)
        self.timer_period = 0.05  # seconds
        self.timer = self.create_timer(self.timer_period, self.control_loop)

        # --- Policy and State Variables ---
        self.ort_session = None
        self.robot_pose_x = 0.0
        self.robot_pose_y = 0.0
        self.robot_yaw = 0.0
        self.robot_lin_vel_x = 0.0
        self.robot_lin_vel_y = 0.0
        self.robot_ang_vel_z = 0.0
        self.last_throttle_action = 0.0
        self.last_steering_action = 0.0

        # Target waypoints (These will need to be dynamically updated in a real application)
        # For this example, we'll use the same square trajectory as in the Isaac Lab environment.
        self.waypoints = np.array([
            [1.0, 1.0], [0.0, 1.0], [-1.0, 1.0], [-1.0, 0.0],
            [-1.0, -1.0], [0.0, -1.0], [1.0, -1.0], [1.0, 0.0]
        ])
        self.current_waypoint_index = 0
        self.is_goal_reached = False
        
        # Load the ONNX model
        self.load_policy()

    def load_policy(self):
        """Loads the ONNX model from the specified file path."""
        try:
            # Use CPUExecutionProvider for simplicity, but you can change this for GPU acceleration
            self.ort_session = ort.InferenceSession(self.policy_path, providers=['CPUExecutionProvider'])
            self.get_logger().info(f'Successfully loaded ONNX policy: {self.policy_path}')
        except Exception as e:
            self.get_logger().error(f'Failed to load ONNX policy: {e}')
            self.ort_session = None

    def odom_callback(self, msg: Odometry):
        """Callback for the odometry subscriber to update the robot's pose and velocity."""
        # Update linear velocities in the robot's body frame
        self.robot_lin_vel_x = msg.twist.twist.linear.x
        self.robot_lin_vel_y = msg.twist.twist.linear.y
        
        # Update angular velocity
        self.robot_ang_vel_z = msg.twist.twist.angular.z
        
        # Update position
        self.robot_pose_x = msg.pose.pose.position.x
        self.robot_pose_y = msg.pose.pose.position.y

        # Update yaw from quaternion
        (roll, pitch, yaw) = euler_from_quaternion([
            msg.pose.pose.orientation.x,
            msg.pose.pose.orientation.y,
            msg.pose.pose.orientation.z,
            msg.pose.pose.orientation.w
        ])
        self.robot_yaw = yaw

    def get_observations(self):
        """
        Gathers and preprocesses the observations from the environment
        to match the input format of the ONNX policy.
        """
        # Calculate errors to the current waypoint
        target_pos_x = self.waypoints[self.current_waypoint_index, 0]
        target_pos_y = self.waypoints[self.current_waypoint_index, 1]

        # Calculate position error vector
        pos_error_x = target_pos_x - self.robot_pose_x
        pos_error_y = target_pos_y - self.robot_pose_y
        
        # Calculate heading to target
        heading_to_target = math.atan2(pos_error_y, pos_error_x)
        
        # Calculate heading error relative to robot's current yaw
        heading_error = heading_to_target - self.robot_yaw
        
        # Check for goal completion (if close to the current waypoint)
        distance_to_target = math.sqrt(pos_error_x**2 + pos_error_y**2)
        if distance_to_target < 0.2:  # Threshold for reaching waypoint
            self.get_logger().info(f"Waypoint {self.current_waypoint_index} reached.")
            self.current_waypoint_index = (self.current_waypoint_index + 1) % len(self.waypoints)
            if self.current_waypoint_index == 0:
                self.is_goal_reached = True
                self.get_logger().info("All waypoints reached. Trajectory complete.")
            
        # Reconstruct the observation vector based on wro_env_square.py
        obs = np.array([
            distance_to_target,
            math.cos(heading_error),
            math.sin(heading_error),
            self.robot_lin_vel_x,
            self.robot_lin_vel_y,
            self.robot_ang_vel_z,
            self.last_throttle_action,
            self.last_steering_action
        ], dtype=np.float32)

        return obs.reshape(1, -1) # Reshape for the ONNX model input

    def control_loop(self):
        """
        Main control loop that runs on a timer.
        It gets observations, runs the policy, and publishes commands.
        """
        if self.ort_session is None or self.is_goal_reached:
            # If the model is not loaded or the goal is reached, stop publishing commands.
            # We're using Float64 messages now, so we need to publish them.
            self.rear_wheel_publisher.publish(Float64(data=0.0))
            self.steer_publisher.publish(Float64(data=0.0))
            return

        # 1. Get observations
        obs = self.get_observations()

        # 2. Run the ONNX model
        input_name = self.ort_session.get_inputs()[0].name
        output_name = self.ort_session.get_outputs()[0].name
        actions = self.ort_session.run([output_name], {input_name: obs})[0]

        # The policy output is assumed to be [throttle_command, steering_command]
        throttle_command = actions[0, 0]
        steering_command = actions[0, 1]

        # Store the last actions for the next observation
        self.last_throttle_action = throttle_command
        self.last_steering_action = steering_command

        # 3. Publish the commands
        # The policy's output directly corresponds to the commands we need to publish.
        # We need to scale them appropriately.
        
        # Create Float64 messages to publish
        rear_wheel_vel_msg = Float64()
        # Scale the throttle command, as done in the Isaac Lab training script.
        rear_wheel_vel_msg.data = float(throttle_command * 2.0)
        
        steer_angle_msg = Float64()
        # Scale the steering command to a valid angle (e.g., +/- pi/4 radians)
        steer_angle_msg.data = float(steering_command * (math.pi / 4))

        # Publish the messages to the correct topics
        self.rear_wheel_publisher.publish(rear_wheel_vel_msg)
        self.steer_publisher.publish(steer_angle_msg)

        self.get_logger().info(f"Published Command: Rear Wheel Velocity={rear_wheel_vel_msg.data:.2f}, Steering Angle={steer_angle_msg.data:.2f}")

def main(args=None):
    rclpy.init(args=args)
    node = PolicyControllerNode()
    try:
        rclpy.spin(node)
    except KeyboardInterrupt:
        pass
    finally:
        node.destroy_node()
        rclpy.shutdown()

if __name__ == '__main__':
    main()

-------------------- FILE: ./my_robot_controller/my_robot_controller/__pycache__/__init__.cpython-310.pyc --------------------
o
    &ç§h    ã                   @   s   d S )N© r   r   r   úQ/home/ubuntu2204/wro_ws/build/my_robot_controller/my_robot_controller/__init__.pyÚ<module>   s    
-------------------- FILE: ./my_robot_controller/my_robot_controller/__pycache__/ros2_policy_controller.cpython-310.pyc --------------------
o
    \Òªh€#  ã                   @   s”   d dl Z d dlmZ d dlmZ d dlmZ d dlmZ d dl	Z
d dlZd dlZd dlmZ d dlZG dd„ deƒZdd	d
„ZedkrHeƒ  dS dS )é    N)ÚNode)ÚFloat64)ÚOdometry)Úeuler_from_quaternion)Úget_package_share_directoryc                       sF   e Zd ZdZ‡ fdd„Zdd„ Zdefdd„Zd	d
„ Zdd„ Z	‡  Z
S )ÚPolicyControllerNodezx
    ROS2 node that controls a differential drive and Ackermann steering robot
    using a pre-trained ONNX policy.
    c                    s4  t ƒ  d¡ |  ¡  d¡ tdƒ}tj |dd¡| _d| _	d| _
d| _d	| _d
| _d| _|  t| jd¡| _|  t| jd¡| _|  t| j| jd¡| _d| _|  | j| j¡| _d | _d| _d| _d| _d| _d| _ d| _!d| _"d| _#t$ %ddgddgddgddgddgddgddgddgg¡| _&d| _'d| _(|  )¡  d S )NÚpolicy_controller_nodez#Policy Controller Node Initialized.Úmy_robot_controllerÚscriptszmy_robot_policy.onnxgœÄ °rh¡?g
×£p=
·?g=
×£p=Â?z/odomz)/steer_bot/rear_wheel_controller/commandsz$/steer_bot/steer_controller/commandsé
   gš™™™™™©?ç        g      ğ?g      ğ¿r   F)*ÚsuperÚ__init__Ú
get_loggerÚinfor   ÚosÚpathÚjoinÚpolicy_pathÚWHEEL_RADIUSÚTRACK_WIDTHÚ
WHEEL_BASEÚ
odom_topicÚrear_wheel_topicÚsteer_topicÚcreate_publisherr   Úrear_wheel_publisherÚsteer_publisherÚcreate_subscriptionr   Úodom_callbackÚodom_subscriberÚtimer_periodÚcreate_timerÚcontrol_loopÚtimerÚort_sessionÚrobot_pose_xÚrobot_pose_yÚ	robot_yawÚrobot_lin_vel_xÚrobot_lin_vel_yÚrobot_ang_vel_zÚlast_throttle_actionÚlast_steering_actionÚnpÚarrayÚ	waypointsÚcurrent_waypoint_indexÚis_goal_reachedÚload_policy)ÚselfÚpackage_share_directory©Ú	__class__© ú_/home/ubuntu2204/wro_ws/build/my_robot_controller/my_robot_controller/ros2_policy_controller.pyr      sH   üşzPolicyControllerNode.__init__c              
   C   sr   zt j| jdgd| _|  ¡  d| j› ¡ W dS  ty8 } z|  ¡  d|› ¡ d| _W Y d}~dS d}~ww )z2Loads the ONNX model from the specified file path.ÚCPUExecutionProvider)Ú	providersz!Successfully loaded ONNX policy: zFailed to load ONNX policy: N)ÚortÚInferenceSessionr   r%   r   r   Ú	ExceptionÚerror)r4   Úer8   r8   r9   r3   U   s   €şz PolicyControllerNode.load_policyÚmsgc                 C   s†   |j j jj| _|j j jj| _|j j jj| _|j	j	j
j| _|j	j	j
j| _t|j	j	jj|j	j	jj|j	j	jj|j	j	jjgƒ\}}}|| _dS )zMCallback for the odometry subscriber to update the robot's pose and velocity.N)ÚtwistÚlinearÚxr)   Úyr*   ÚangularÚzr+   ÚposeÚpositionr&   r'   r   ÚorientationÚwr(   )r4   rA   ÚrollÚpitchÚyawr8   r8   r9   r   _   s   



ü
z"PolicyControllerNode.odom_callbackc           	   	   C   sö   | j | jdf }| j | jdf }|| j }|| j }t ||¡}|| j }t |d |d  ¡}|dk rZ|  ¡  	d| j› d¡ | jd t
| j ƒ | _| jdkrZd| _|  ¡  	d¡ tj|t |¡t |¡| j| j| j| j| jgtjd	}| dd
¡S )z†
        Gathers and preprocesses the observations from the environment
        to match the input format of the ONNX policy.
        r   é   é   gš™™™™™É?z	Waypoint z	 reached.Tz+All waypoints reached. Trajectory complete.)Údtypeéÿÿÿÿ)r0   r1   r&   r'   ÚmathÚatan2r(   Úsqrtr   r   Úlenr2   r.   r/   ÚcosÚsinr)   r*   r+   r,   r-   Úfloat32Úreshape)	r4   Útarget_pos_xÚtarget_pos_yÚpos_error_xÚpos_error_yÚheading_to_targetÚheading_errorÚdistance_to_targetÚobsr8   r8   r9   Úget_observationsu   s4   



ø	÷z%PolicyControllerNode.get_observationsc           	      C   s   | j du s| jr| j tdd¡ | j tdd¡ dS |  ¡ }| j  ¡ d j}| j  	¡ d j}| j  
|g||i¡d }|d }|d }|| _|| _tƒ }t|d ƒ|_tƒ }t|tjd  ƒ|_| j |¡ | j |¡ |  ¡  d	|jd
›d|jd
›¡ dS )z€
        Main control loop that runs on a timer.
        It gets observations, runs the policy, and publishes commands.
        Nr   )Údatar   )r   r   )r   rO   g       @é   z'Published Command: Rear Wheel Velocity=z.2fz, Steering Angle=)r%   r2   r   Úpublishr   r   rc   Ú
get_inputsÚnameÚget_outputsÚrunr,   r-   Úfloatrd   rS   Úpir   r   )	r4   rb   Ú
input_nameÚoutput_nameÚactionsÚthrottle_commandÚsteering_commandÚrear_wheel_vel_msgÚsteer_angle_msgr8   r8   r9   r#   Ÿ   s&   &z!PolicyControllerNode.control_loop)Ú__name__Ú
__module__Ú__qualname__Ú__doc__r   r3   r   r   rc   r#   Ú__classcell__r8   r8   r6   r9   r      s    @
*r   c                 C   st   t j| d tƒ }z'zt  |¡ W n	 ty   Y nw W | ¡  t  ¡  d S W | ¡  t  ¡  d S | ¡  t  ¡  w )N)Úargs)ÚrclpyÚinitr   ÚspinÚKeyboardInterruptÚdestroy_nodeÚshutdown)ry   Únoder8   r8   r9   ÚmainÎ   s   ÿÿıÿ
r   Ú__main__)N)rz   Ú
rclpy.noder   Ústd_msgs.msgr   Únav_msgs.msgr   Útf_transformationsr   Úonnxruntimer<   Únumpyr.   rS   Úament_index_python.packagesr   r   r   r   rt   r8   r8   r8   r9   Ú<module>   s     
@
ÿ
-------------------- FILE: ./my_robot_controller/setup.py --------------------
import os
from glob import glob
from setuptools import setup

package_name = 'my_robot_controller'

setup(
    name=package_name,
    version='0.0.0',
    packages=[package_name],
    data_files=[
        ('share/ament_index/resource_index/packages',
            ['resource/' + package_name]),
        ('share/' + package_name, ['package.xml']),
        # Corrected line to install the ONNX policy file from the scripts directory
        (os.path.join('share', package_name, 'scripts'), glob('scripts/*.onnx')),
    ],
    install_requires=['setuptools'],
    zip_safe=True,
    maintainer='user',
    maintainer_email='user@todo.todo',
    description='TODO: Package description',
    license='TODO: License declaration',
    tests_require=['pytest'],
    entry_points={
        'console_scripts': [
            'ros2_policy_controller = my_robot_controller.ros2_policy_controller:main'
        ],
    },
)

-------------------- FILE: ./my_robot_controller/test/test_pep257.py --------------------
# Copyright 2015 Open Source Robotics Foundation, Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

from ament_pep257.main import main
import pytest


@pytest.mark.linter
@pytest.mark.pep257
def test_pep257():
    rc = main(argv=['.', 'test'])
    assert rc == 0, 'Found code style errors / warnings'

-------------------- FILE: ./my_robot_controller/test/test_copyright.py --------------------
# Copyright 2015 Open Source Robotics Foundation, Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

from ament_copyright.main import main
import pytest


# Remove the `skip` decorator once the source file(s) have a copyright header
@pytest.mark.skip(reason='No copyright header has been placed in the generated source file.')
@pytest.mark.copyright
@pytest.mark.linter
def test_copyright():
    rc = main(argv=['.', 'test'])
    assert rc == 0, 'Found errors'

-------------------- FILE: ./my_robot_controller/test/test_flake8.py --------------------
# Copyright 2017 Open Source Robotics Foundation, Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

from ament_flake8.main import main_with_errors
import pytest


@pytest.mark.flake8
@pytest.mark.linter
def test_flake8():
    rc, errors = main_with_errors(argv=[])
    assert rc == 0, \
        'Found %d code style errors / warnings:\n' % len(errors) + \
        '\n'.join(errors)

-------------------- FILE: ./my_robot_controller/package.xml --------------------
<?xml version="1.0"?>
<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>
<package format="3">
  <name>my_robot_controller</name>
  <version>0.0.0</version>
  <description>TODO: Package description</description>
  <maintainer email="ubuntu2204@todo.todo">ubuntu2204</maintainer>
  <license>TODO: License declaration</license>

  <exec_depend>rclpy</exec_depend>
  <exec_depend>geometry_msgs</exec_depend>
  <exec_depend>nav_msgs</exec_depend>
  <exec_depend>tf_transformations</exec_depend>

  <!-- The build type must be ament_python for Python packages -->
  <export>
    <build_type>ament_python</build_type>
  </export>
</package>

-------------------- FILE: ./my_robot_controller/scripts/my_robot_policy.onnx --------------------
pytorch2.7.0:Ğ5
¾
input
net_container.0.weight
net_container.0.bias,/net_container/net_container.0/Gemm_output_0#/net_container/net_container.0/Gemm"Gemm*
alpha  €? *
beta  €? *
transB 
‡
,/net_container/net_container.0/Gemm_output_0,/net_container/net_container.1/Relu_output_0#/net_container/net_container.1/Relu"Relu
å
,/net_container/net_container.1/Relu_output_0
net_container.2.weight
net_container.2.bias,/net_container/net_container.2/Gemm_output_0#/net_container/net_container.2/Gemm"Gemm*
alpha  €? *
beta  €? *
transB 
‡
,/net_container/net_container.2/Gemm_output_0,/net_container/net_container.3/Relu_output_0#/net_container/net_container.3/Relu"Relu
½
,/net_container/net_container.3/Relu_output_0
policy_layer.weight
policy_layer.bias/policy_layer/Gemm_output_0/policy_layer/Gemm"Gemm*
alpha  €? *
beta  €? *
transB 
2
/policy_layer/Gemm_output_0output/Tanh"Tanh
main_graph*¡ Bnet_container.0.weightJ€¿Â Ğ¿ß$í¼3%¿½å¼=sc­½½ÖÇ£¾T{¼ì<<ãZ¿§İô>"?R¬–>‡R>\¿=±Â¾Ø¾V=¦³>“õY>7AG>K"¬>Õy¿‡íq¿fÊ?Ğö<`ä£=ß4b>`ô‘>_º£=ÖYx¾²;¾u”¾Ïp¾9ë;?Z:Q¾q?i¾&T¾^»Œ?QÃ%¿#©ö¾ ¼%?4U¼° ä¾‹¾‹‚/=HÎÁ¿><‹¿è«‹¾FuÁ¿9†b¿Ó1z>JÕ¼=ÃÇ¾e·¿\İƒ>~Ô?õ™ˆ¿Ì>Õ6>s37=(5f¾kØ¥=¡¿SÍ8?Îa¿÷ï¿œûp¾Óf´¾Åt>?`^?lYº¾0Ğ½"ú?Û
°=ÌS!¿¶ÖA¿«€˜½Ê²"?‰êô¾7, ¿×¤»»j?<‹¿<%Æ—½÷;Õ½ÿĞM>%7>é‘+ºµø¯?›Yë>­ ¿J¹°¾Ì“>ÿæ¾ÈÊ½ê¯=R›|¾T/>´®¾Uº­>Š ?’Qû=v+Q¾Ò.a¾0
f¾¢ñ>g—>V'­=¢€!¾ò&ì¾6Fí?JçA?«Øƒ?À__¾_x½Äº2¾/HP>ëñ>V±?ßó>Xû÷?Ïƒ?q¾p»ò=ãâ¾²s¾òØ¾)C±>x?Pˆ¼¿¾C>ü. =&¸¾”Á¾‚×»êÕ>@UÓ<TW!½vN<*ˆs½q•¾òÛÿ¼Òo¿#:Î¾wª?‹$}¾ ¸½aEŠ¾Ø»¾f„?wQ.½êâ¾àÕ‰=ªWE>LÁš>{âÁ¾Ü¨?µ`>Ëî-½m¾È¿Û=ï¾ò»>ÑÖ?4ĞÓ>ˆE„¿†>¢ª>Ê8?>w±E¿¼Œ7=kß¾½(@€¾«Û¾hŞü=N¬?÷¾é.À>u¼²¾"İ<AŒ‘=m’?‡³Ê¿mY>ygü?Èû#¿P™¾Òµü<í2»èz(¾_µ#> r?¨Q?ËÜD¿Š!?ø:À>î¾fÜI¾0{¢¾ş½›½™È:¿8e>;¶¾ğæİ½ç¿êÕ
½ÀªÇº ¸¼å–E<lŒ'<Œ@¿ç&&?6*=E>¨@Íxt?–™0¾©?ªÍ<¬[7>¯\'¿¥>¾ºª¾äş>? ˆİ¿{6>Æ”>OAq=¬[¾FÑ>l_>‚ª?Œ@Ç Â>Uœ¢>±RÍ>‘!Ó>‡¡¾›l>Ğ—?;”>5Ê•¾Ì,¾´a>ëD¾ÔÅ¾8o¹<‚‘^½8†>½%¾Zˆ½¯a½<á¾‹µ¼* Bnet_container.0.biasJ€“£D¿uTÎ¾¦:=¿Ù|5¾Jø…¾b#Ü¾<7©<N÷m¿çÊ½g¯ï¾Aê¾Å™J¾aÔÍ¾?÷Î¾p‹?:‘¿ù´½şÿÈ½ä%×½I&^¾ß’¾cP_>u´¢¾H©ºAT‰>ØDm¾>€¼»Ñì¿ÁU:¿€Æ‘¿İ¼£¾íÂ>*¡   Bnet_container.2.weightJ€ Dg<=àôL½ˆ½•ÛÆ;b;œ<¢í<ö;¼¡¼OD¼<ì½Rû„<=zîy<i½g™8¼Ï6)½DÖs½üJ=¼ÑÎ»bCD=âK=İ¨/;²Å¼[»©È=@°E¼ğ€=£„<Ğ~=§Ó`9°·=9@^…¼Y¢_¾<>+=ŠrK¾u|>¼P<òä>NU€=]Ül½÷5½‡dŞ½ûFÄ=w¤a=$Æ½¡µ½i‹½Ö…=bú=µËï½@)ò<U0…><—=Iå€¼©»4¼¦²½M©z=Ø&½5NR>­dà=Š½ö¾4²÷½º~£=õsf½:¿P[?€Â¨¿B_a½~Ã­¿V¤n>ógZ¿_Rz¾°ğ<²¾ÃV>êşÆ½Šqï½j®ò¿%`‹? ›?rXÉ>û®z¿¹Ö=sg2=ª*¾Gşº¾±KÀ2é?ï}Q¾½ˆ©=Ü¿µL‹=;0{?î/w¿“Ù–¾mã€>Ml2=^É¾ÓÖ<Jd¿Z°Ç=`U>«=¾0´ù>pZ?yÜ À'Ú¿Û¤?Ã½Z¿ìzµ¿½¼?úø >#?_¾n¨¾î¿é¾d0¿C ¾Q·—>Wë;{+4?.÷¥¾¸c?/p½ ”Ş?	şØ>şæ…¿¾±¨½\Hd=¯€¾÷â<—†<KZ›=!ì¤=‹÷»Jc¹ï>ô½¶à<±N>|&½'0×=Q6<CQ:½\ğo½‚HI¼»s“=Änz<™Qú=)I¡¼1¤<¨69}J=Ğ¬«½Å½ØZ‡:4¾ª}¾éG[½‚JX=Òx º¾Æ>†F?F§ë½Ve¶>N»>^Ì¤>W8¾I¼es`:b`×=‘y>ÂQu½5¯>^>¼jâà>ËÒ#¿±ò½s7Ê>R|½Îë=F%À¾Q?$„r>œxx¾İSö½&Ä¼¯¿<?xìˆ=[Fš>7è“¾Â¯<¾]%Ñ<d‡½*â˜<Ï7½„
¾Æ+)½°‘»Ş/ª½8‘’¼å°¤=—ùş¼y$»åõ?<”Y>R—X<Tz=l—Ì¼‡d†;ø^¼æn¼ç‹O=îûY½B­>aÙ<xÿi=Ë1‚½€Ã@½Î~¼ª‘=º¦·½N8Ê¼h¢Ú¼“›¤½c±>ô	>8ş”¾¿G*>LÑ=ªï†=Å¬–¾ú4I><x>à@¥¾úk¢¾%û¾;( ¾Ğ|U<2 ¾ôí›¾íÚœ½ğê-¿<Xº:*c>d[¾¤Ä½‡Mº¿vq¾Sï½Ş±_=x¶¨¾lK	>pè<]¾Éi¹=ø¿İìM¾ó=‡HÍ>A*=œO½ÜF¿‹Ûì>‹½|¾ÖX¿8Æş>&Õg½FsI>Nç*>¯3¦¾¤z?&F´½¦õw>I¿Çz…¾§¿[s*?kñ>e†$¿úÊ/¿–ƒ§½¯×,½¦ã¾LÇ=ì$|¿¦>Í`S¾.RF½“7/½ÃW\¼Ã‡¼½\™ô¼MD<ß¦=`­<…4Ö¼b7=öÁŠ<7P=]½™Í
=Úv®½b“»€ü½¡»f~@=j°í<N†º½fl¼šb:ĞD<0U<=—lÜ=“q;‹Cğ¼6eÇº&æ‹½nÁ§=1{Ô=\d>²ï4?)ûv>Éd8?6¾é=†-¿Ù =ÿ~
À&ÌU½¿¾“º‹>Ú7p>‚¾aÜÍ½ Ó>š¶É½d‰²>»ùØ½j}½ê£¾äò¼_ŠO>PM¿¶¦–=éõ>½¿4=HK¿Šu=ym;®r<=W—=ò
¼½Ç3N=˜!½šüÀ9Æ¸q<òØ<j	é;Ó	,¼Ö§<­Ñ=+»&½î‡½ ñ£=â)=˜GÕ¼¬øs=ò	À<Ã C¼>¾ó½Óº¼›^L¼«»XØ=ÙŒÙ½¶Ø½¢R¾¸ç½KØ¼{F‡=½È.¼15’=İU§¾P¤w½Êj>ŠÑ™½¡İW¿¬‡¼7dq½¨iT>©ó\>øQà=*Ï¾Àí:¾C>·!¶½ å»½,ı†8?¦ÎZ>×„Ä¾`7"¾¸=ÏAª¾H´$?ó'È=kÏ>?;½ñWÑ½ï>‡L">Àb>á×b¾ü7ö¾À‡¾›]=	>zÂb=¯p½Ö¾ŒV=BÍ¬¼\
=<„½sï<—>< ë½¼½½Õ^½µÄW¾š0º¼‰Î„½û%Ò=­L¤¼D€ª½'Ûd<Ml]½ôO½Õ1½Ø&½'rg½Ïİ’=In!¾ä¤¿=yu`½âFN>g™<ÃúX=¶=P¯¼šC¾´+¼®İ,<±L…½–· ¼óã=É9ˆ</1½Å¯m»>¯¼ac=–Ç^=Äëë<¨=…@»¿ÿ¾ào¾%¾YÛl="ÔÇ:'Am¼`à½ÎZ[<•cM½Ó$•=a3'<M³c='Ò<ˆ+®¼‘ÍS½;’M=Kè½Å{Ø=Ïod¼¯òœ<³“¯¼o¶h½\O¼Nã¼Ä©@<ç‚V=Ô	¾­½ƒz==µ¼ îL;k½˜«X½§Óí=€ÎË=Y¬=fWÈ=§‚»Aªt=)™9¾Ç>¼š×
>ÛyºF'¥=VZ¶½§±¼(%4>È :<ã4$>0’/¾`$0¿x¼½o+–½¤’=’?Â¾oïó=Ë¿qÃ‹½(M>;¿“Ê!¿sHË¾¡';¼e	®¾´Rü<^ÚV>‹,–½1›¨¾Kó¸½ø.À=ò›¾_ñ½é’>õ=Û	¿ˆ¡{=1Ê›¼.V=à>YK½,1I½Í½óñm=vA¼½?€=z1=1Ëq<*äË<H—İ½ï½ˆ<0ºÚ;	V´<ï_>¡Ó¼Î5¨<ÏøH½şj¬=#ö¾Å‘½?Vx¼‰Vî<«»=<‰ñ=-M=^u†½ô{½èâŠ¼\ì=BU½ïÿ?â—%?!»Ä¾ÃN'Àâ¤w¿ìO«>çH ¿ş`>?ÒÄª½Sâ> jÎ¾,¾´ˆ>S•;¿÷"ê¿S&§?&g?,ã>$àl=°E–>îÃ>=íÅİ>.e?9¿o ‚¾,Œ>cE>¾á¯¿­ã½TûÛ>·lM¾,=>7¾_ûí½N«½4¾‹<Î‘Î=‚6õ¼T‡§<fş‹=–$ø½¿Ñ@>$û5¾HŠ=>Ìs·½ C¾¾%¼äk!=sæ=Ê¿-½å">vĞA>²\ı¼º ‘=˜~»OM¾>hÿ‡¾	0Ò=È¬+¾š,>Şµ=]Ïó=‹b=¿+¾ÕºÆ½zŠg<Bfâ<A÷<ÕH½MÎ¼|X>½võl=Æù°<€k½åé<aı=m‘½ÏÄ»Âã’<C¨¹C]½lj.½±ô=8»\<â;Ëe¼jš»ª1P¾;ú;F1À<á>c§<=+©Ô<ÄJT½\†@ùén¾M„õ¾óI¿ŠEo¿çM–¿ºÊ×¿ÙÄ¡¿•Æ,¿WvR>‰†­¾q¯ï½¾­`>'S>Pc˜=û2>ãŞ²>šôş>óLL¿äÍ4¿ö®¾@ò"=˜.÷¾­_Y>\x“¿‹-?D÷'½±?&@Ìßa?¿	?‘Û
¾0k?1Ày¾ê”®½{¿Ã¤Ì¾fj½'Ñ½ÚÎë>û%¿
›Î¼l¿¼—´¤¾ôMl>Gò¢¾Hğ”¿Z7f¿ù²ı><ŒÈ½ÂÕ‚>´±i>Ş8½Ü©=-æ¿I>şÑ¿"Á>}Ôr¼¬ŸU?¿b?v´¾­l¿·R¾±Yl>¹.K¾‰¿‰¨Ÿ>q"{>ZF3>ù­=½¼Ğ‡¿ÂÑ=¿ÙÂÃ>ò„|½êÙç>czÈ¾üÿ?˜‘'>b–]¿¼•Ğ>Şö¾)eÃ¾úwÃ>ÈÈ,¾ûú”>ÌÆ®¾\‰M¾ŞÅ?MZÉ>#M¾¤Óí½Ê7s?Iï~>à<‘>M•»¾.ğ¼ºQˆ¿ Ó=¾rî½-0¾ÉÄ¾zr¿o2à¾Í­ú=@%¼ë%½Ï™¤>ù£E½¬ë›½Rˆõ»¢’•>Íõ¾U,Ë¼6ş>à²Ó»“P=ÿ‚†¼ØAV¾°ª=!2ª=©Ş3¾Ø¬’¼~(«¾¬«Ö¾ü©ı>%¡Z¼ÅCÖ<+G,½X‰=‡›º:ş ½:}Å=ÕAB½wg·=çUV>óš=f4=Z¤=EÍi¹„"=”¡÷½–Ñ»õÉÒ¼ŸÒ8½.ÙC½İF¯½å?Q=Ñ‰½©ª;F¾8WT=+ñ<.>ó<¤<½Û¢¼š&R¾øM^=Ä¡³;‹Ö"=şÆ><&#¾>"¾]½Tkl>‚è¾ø›°¾¯Ü¦>†K#¾jñ¾¾®*Å>µ:Ğ¾¹-x>šƒ=Ñßø¾éÙ¼¿:§>¸­«=V=I¿®)¼ÆÓã¾såe>Š$_>Õm¿‡ƒ¿34—½õÎ¼‹Ùû>@Á¿=•½¿=‹>âv¾ÿÌ=¼&ùº<~çÎ¼?|¥¼p]®<Ó¼/¯’<b·=’<=n\¼VXê;Œ÷<S¡C=ï`ì<&X/=Ôó½–>˜½+Ö˜=@<¹D§<&€q=ê•<]¶ß¼bq}<£{A:zc:=<<^¿»« ½´B=—ÿ¼ì»=Úá’¼ü·²=»Š¼;=V=ıZ0¾|ã¶<|>½½ÆŞ½ÄÍ¼;\="öµ=s¡‡½Mä»Ö€•½İ¥˜¼^O–=u¬I=âD‘¼şñ\=£]Œ½ÙÓg½ÄÄ¼Hlo<únu½ .½²¢;²º=‡ <²Ûİ;ÓñÙ¼½C<CÙ$½Ş«¤<ª”ˆ=ÀGd»yÜ.<œÊg;PÇu¼O@U=Œà¯=+p<æ|=½­f»<¸<=›îâ;Ê´’½02B<æ·5½ıQÖ½x¤›¼ëñÜ<,Á„<öcq½¨]m¼8}½Ig×;ö=~µ'½ÛFÿ=DĞ#¼QDÁ½É²<²²=äŸ¼!8½<@>«ij½L =oDÿ<İóñ»bëù<ŞÄg½Uv<²õ“»ŠÍ8½e1å=.[=Vò”=îº¢=»b¾p½Z¦­=Êa=qÈœ¼êÑ½“6â=¢½¢Ôx<à+D½Ò½Œ¿¼nÛæ¼„¥¼
Ï°<4½ú9>L&§> •¾¶8Ş¾9`@À•I¨¿L*„¿©å¿`[?ğÄ ¾lˆ>bÒQ¿†\ü>Î>@‚·½—Y*Àğû?ÜM\?W™¿Ù»§“^¿›j[?=W3?ºç&¿×aE¿xu¾ßV =:Îœ¾f„8¿Œë˜¾úá£?Eã ¿O>* Bnet_container.2.biasJ€a½İ`Ş½=?Ù¿¼I„¿2p¾Œ¾Ÿá<ÎÎ¾j¿¿“´Ñ½Ã1¿¿·Ë½§@	¾±¦¾Õe½Ì,Ğ=+©¿M =Æm·¿=+ƒ>I¦Ò=`Ë¿:òg¿\¿eÿ¿Ù‡½—j-¿Jø½d<‚=çzğ½ÚÕ¾¡íd¿* Bpolicy_layer.weightJ€Îzyº_”½ººÍ½–ê­¹4YÙ¹ü`U¾§İ‹º%’¸= ¡®<{1‡¹s`¸½ŠÔ:Ü«Î=êŠ‚:w³Šº`Uº	Bs½p :Êru¾j=Q;øq@¹'ö= ¾Wg<“Í;ì2§:)|4<C¨;½}ºšZ†º„±u¹Gà˜½êÚºMºVúõ=Æô ¼Ì˜W;¢ş<tl`¹±Á†¾Ù5ÚºÍÚ‘:øQ
»T6;8x:zî:´W³ºü\ºXe¾^M¹6 &½’”ª:íuº)¬`¼.Â—;ÿ’~7Ì1£>€:º¡S¾ùõ;;>wÜºŒKPºÕ£ ;PÜ¼*!Bpolicy_layer.biasJ³?&¾Z!
input


batch_size
b"
output


batch_size
B
-------------------- FILE: ./my_robot_controller/resource/my_robot_controller --------------------

-------------------- FILE: ./my_robot_gazebo/CMakeLists.txt --------------------
cmake_minimum_required(VERSION 3.8)
project(my_robot_gazebo)

if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES "Clang")
  add_compile_options(-Wall -Wextra -Wpedantic)
endif()

# Find necessary ROS 2 packages that are required for the build
find_package(ament_cmake REQUIRED)
find_package(rclcpp REQUIRED)
find_package(gazebo_ros REQUIRED)
find_package(robot_state_publisher REQUIRED)
find_package(urdf REQUIRED)
find_package(xacro REQUIRED)

# Install directories to the share folder
install(
  DIRECTORY launch urdf worlds config
  DESTINATION share/${PROJECT_NAME}
)

# Finalize the package
ament_package()

-------------------- FILE: ./my_robot_gazebo/config/robot_controllers.yaml --------------------
controller_manager:
  ros__parameters:
    update_rate: 100

    joint_state_broadcaster:
      type: joint_state_broadcaster/JointStateBroadcaster

    ackermann_steering_controller:
      type: ackermann_steering_controller/AckermannSteeringController

ackermann_steering_controller:
  ros__parameters:
    # Use the correct parameter names for the controller
    rear_wheels_names: ["rear_left_wheel_joint", "rear_right_wheel_joint"]
    front_steering_joints_names: ["front_left_steer_joint", "front_right_steer_joint"]

    # Robot physical parameters from your config
    wheel_separation: 0.09   # Corresponds to wheel_track
    wheel_base: 0.1425
    wheel_radius: 0.034

    # Odometry settings
    open_loop: false
    odom_frame_id: odom
    base_frame_id: base_link
    publish_rate: 50.0

-------------------- FILE: ./my_robot_gazebo/urdf/my_robot2.urdf --------------------
<?xml version="1.0" ?>
<!-- =================================================================================== -->
<!-- |    This document was autogenerated by xacro from steer_bot.urdf.xacro           | -->
<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED                                 | -->
<!-- =================================================================================== -->
<!--
  Robot model adapted from https://github.com/CIR-KIT/steer_drive_ros/blob/kinetic-devel/steer_drive_controller/test/common/urdf/steerbot.xacro

  Modifications:
    Remove base_footprint link. Useful for navigation but not necessary for a simple example.
    Added materials for URDF
    Updated inertials

  Geometry:
    The Ackermann steering controllers require the longitudinal
    separation between the front and back wheel axes and the
    lateral separation between the left and right front steering axes.
    
    For this model:
    wheel_separation_h = base_length - 2 * axle_offset = 0.4
    wheel_separation_w = base_width + 2 * axle_offset = 0.4
-->
<robot name="steer_bot">
  <material name="red">
    <color rgba="0.8 0 0 1"/>
  </material>
  <material name="green">
    <color rgba="0 0.8 0 1"/>
  </material>
  <material name="blue">
    <color rgba="0 0 0.8 1"/>
  </material>
  <material name="yellow">
    <color rgba="0.8 0.8 0 1"/>
  </material>
  <material name="orange">
    <color rgba="0.8 0.25 0 1"/>
  </material>
  <material name="black">
    <color rgba="0 0 0 1"/>
  </material>
  <material name="dark_gray">
    <color rgba="0.5 0.5 0.5 1"/>
  </material>
  <material name="gray">
    <color rgba="0.753 0.753 0.753 1"/>
  </material>
  <material name="silver">
    <color rgba="0.88 0.88 0.88 1"/>
  </material>
  <material name="white">
    <color rgba="1 1 1 1"/>
  </material>
  <!-- Gazebo plugins -->
  <gazebo>
    <!-- Load ros_control plugin using the steer_bot_hardware_gazebo
    implementation of the hardware_interface::RobotHW -->
    <plugin filename="libgazebo_ros_control.so" name="gazebo_ros_control">
      <robotNamespace>/steer_bot</robotNamespace>
      <robotSimType>steer_bot_hardware_gazebo/SteerBotHardwareGazebo</robotSimType>
      <legacyModeNS>false</legacyModeNS>
    </plugin>
  </gazebo>
  <!-- Base link -->
  <link name="base_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.2 0.09 0.05"/>
      </geometry>
      <material name="green"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.2 0.09 0.05"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="2.5"/>
      <inertia ixx="0.0022083333333333334" ixy="0.0" ixz="0.0" iyy="0.008854166666666668" iyz="0.0" izz="0.010020833333333335"/>
    </inertial>
  </link>
  <link name="front_steer_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.02" radius="0.05"/>
      </geometry>
      <material name="yellow"/>
    </visual>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="1"/>
      <inertia ixx="0.0006583333333333334" ixy="0.0" ixz="0.0" iyy="0.0006583333333333334" iyz="0.0" izz="0.0012500000000000002"/>
    </inertial>
  </link>
  <joint name="front_steer_joint" type="revolute">
    <parent link="base_link"/>
    <child link="front_steer_link"/>
    <origin rpy="0 0 0" xyz="0.08750000000000001 0 0.079"/>
    <axis xyz="0 0 1"/>
    <limit effort="10.0" lower="-3.141592653589793" upper="3.141592653589793" velocity="5.0"/>
  </joint>
  <transmission name="front_steer_joint_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <actuator name="front_steer_joint_motor">
      <mechanicalReduction>1</mechanicalReduction>
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
    </actuator>
    <joint name="front_steer_joint">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
    </joint>
  </transmission>
  <gazebo reference="front_steer_link">
    <material>Gazebo/Yellow</material>
  </gazebo>
  <link name="rear_wheel_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.0135" radius="0.0085"/>
      </geometry>
      <material name="yellow"/>
    </visual>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.015625"/>
      <inertia ixx="5.1953125e-07" ixy="0.0" ixz="0.0" iyy="5.1953125e-07" iyz="0.0" izz="5.644531250000001e-07"/>
    </inertial>
  </link>
  <joint name="rear_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child link="rear_wheel_link"/>
    <origin rpy="-1.5707963267948966 0 0" xyz="-0.08750000000000001 0 0"/>
    <axis xyz="0 0 1"/>
  </joint>
  <transmission name="rear_wheel_joint_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <actuator name="rear_wheel_joint_motor">
      <mechanicalReduction>1</mechanicalReduction>
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </actuator>
    <joint name="rear_wheel_joint">
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </joint>
  </transmission>
  <gazebo reference="rear_wheel_link">
    <material>Gazebo/Yellow</material>
  </gazebo>
  <link name="front_right_steer_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.02" radius="0.05"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="1"/>
      <inertia ixx="0.0006583333333333334" ixy="0.0" ixz="0.0" iyy="0.0006583333333333334" iyz="0.0" izz="0.0012500000000000002"/>
    </inertial>
  </link>
  <joint name="front_right_steer_joint" type="revolute">
    <parent link="base_link"/>
    <child link="front_right_steer_link"/>
    <origin rpy="0 0 0" xyz="0.08750000000000001 -0.057499999999999996 0.079"/>
    <axis xyz="0 0 1"/>
    <limit effort="10.0" lower="-0.7853981633974483" upper="0.7853981633974483" velocity="5.0"/>
  </joint>
  <link name="front_right_wheel_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.027" radius="0.034"/>
      </geometry>
      <material name="red"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.027" radius="0.034"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.5"/>
      <inertia ixx="0.000174875" ixy="0.0" ixz="0.0" iyy="0.000174875" iyz="0.0" izz="0.00028900000000000003"/>
    </inertial>
  </link>
  <joint name="front_right_wheel_joint" type="continuous">
    <parent link="front_right_steer_link"/>
    <child link="front_right_wheel_link"/>
    <origin rpy="-1.5707963267948966 0 0" xyz="0 0 -0.079"/>
    <axis xyz="0 0 1"/>
  </joint>
  <transmission name="front_right_steer_joint_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <actuator name="front_right_steer_joint_motor">
      <mechanicalReduction>1</mechanicalReduction>
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
    </actuator>
    <joint name="front_right_steer_joint">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
    </joint>
  </transmission>
  <transmission name="front_right_wheel_joint_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <actuator name="front_right_wheel_joint_motor">
      <mechanicalReduction>1</mechanicalReduction>
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </actuator>
    <joint name="front_right_wheel_joint">
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </joint>
  </transmission>
  <gazebo reference="front_right_steer_link">
    <material>Gazebo/Blue</material>
  </gazebo>
  <gazebo reference="front_right_wheel_link">
    <material>Gazebo/Red</material>
  </gazebo>
  <link name="front_left_steer_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.02" radius="0.05"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="1"/>
      <inertia ixx="0.0006583333333333334" ixy="0.0" ixz="0.0" iyy="0.0006583333333333334" iyz="0.0" izz="0.0012500000000000002"/>
    </inertial>
  </link>
  <joint name="front_left_steer_joint" type="revolute">
    <parent link="base_link"/>
    <child link="front_left_steer_link"/>
    <origin rpy="0 0 0" xyz="0.08750000000000001 0.057499999999999996 0.079"/>
    <axis xyz="0 0 1"/>
    <limit effort="10.0" lower="-0.7853981633974483" upper="0.7853981633974483" velocity="5.0"/>
  </joint>
  <link name="front_left_wheel_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.027" radius="0.034"/>
      </geometry>
      <material name="red"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.027" radius="0.034"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.5"/>
      <inertia ixx="0.000174875" ixy="0.0" ixz="0.0" iyy="0.000174875" iyz="0.0" izz="0.00028900000000000003"/>
    </inertial>
  </link>
  <joint name="front_left_wheel_joint" type="continuous">
    <parent link="front_left_steer_link"/>
    <child link="front_left_wheel_link"/>
    <origin rpy="-1.5707963267948966 0 0" xyz="0 0 -0.079"/>
    <axis xyz="0 0 1"/>
  </joint>
  <transmission name="front_left_steer_joint_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <actuator name="front_left_steer_joint_motor">
      <mechanicalReduction>1</mechanicalReduction>
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
    </actuator>
    <joint name="front_left_steer_joint">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
    </joint>
  </transmission>
  <transmission name="front_left_wheel_joint_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <actuator name="front_left_wheel_joint_motor">
      <mechanicalReduction>1</mechanicalReduction>
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </actuator>
    <joint name="front_left_wheel_joint">
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </joint>
  </transmission>
  <gazebo reference="front_left_steer_link">
    <material>Gazebo/Blue</material>
  </gazebo>
  <gazebo reference="front_left_wheel_link">
    <material>Gazebo/Red</material>
  </gazebo>
  <link name="rear_right_wheel_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.027" radius="0.034"/>
      </geometry>
      <material name="red"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.027" radius="0.034"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.5"/>
      <inertia ixx="0.000174875" ixy="0.0" ixz="0.0" iyy="0.000174875" iyz="0.0" izz="0.00028900000000000003"/>
    </inertial>
  </link>
  <joint name="rear_right_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child link="rear_right_wheel_link"/>
    <origin rpy="-1.5707963267948966 0 0" xyz="-0.08750000000000001 -0.057499999999999996 0"/>
    <axis xyz="0 0 1"/>
  </joint>
  <transmission name="rear_right_wheel_joint_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <actuator name="rear_right_wheel_joint_motor">
      <mechanicalReduction>1</mechanicalReduction>
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </actuator>
    <joint name="rear_right_wheel_joint">
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </joint>
  </transmission>
  <gazebo reference="rear_right_wheel_link">
    <material>Gazebo/Red</material>
  </gazebo>
  <link name="rear_left_wheel_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.027" radius="0.034"/>
      </geometry>
      <material name="red"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.027" radius="0.034"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.5"/>
      <inertia ixx="0.000174875" ixy="0.0" ixz="0.0" iyy="0.000174875" iyz="0.0" izz="0.00028900000000000003"/>
    </inertial>
  </link>
  <joint name="rear_left_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child link="rear_left_wheel_link"/>
    <origin rpy="-1.5707963267948966 0 0" xyz="-0.08750000000000001 0.057499999999999996 0"/>
    <axis xyz="0 0 1"/>
  </joint>
  <transmission name="rear_left_wheel_joint_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <actuator name="rear_left_wheel_joint_motor">
      <mechanicalReduction>1</mechanicalReduction>
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </actuator>
    <joint name="rear_left_wheel_joint">
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </joint>
  </transmission>
  <gazebo reference="rear_left_wheel_link">
    <material>Gazebo/Red</material>
  </gazebo>
  <!-- Camera Link -->
  <link name="camera_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.03 0.03 0.03"/>
      </geometry>
      <material name="red"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.03 0.03 0.03"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.1"/>
      <inertia ixx="1.5e-05" ixy="0.0" ixz="0.0" iyy="1.5e-05" iyz="0.0" izz="1.5e-05"/>
    </inertial>
  </link>
  <joint name="camera_joint" type="fixed">
    <parent link="base_link"/>
    <child link="camera_link"/>
    <origin rpy="0 0 0" xyz="0.1 0 0.025"/>
  </joint>
  <!-- Ultrasonic Sensor Links -->
  <link name="ultrasonic_front_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 0.02 0.02"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 0.02 0.02"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.05"/>
      <inertia ixx="3.3333333333333337e-06" ixy="0.0" ixz="0.0" iyy="3.3333333333333337e-06" iyz="0.0" izz="3.3333333333333337e-06"/>
    </inertial>
  </link>
  <joint name="ultrasonic_front_joint" type="fixed">
    <parent link="base_link"/>
    <child link="ultrasonic_front_link"/>
    <origin rpy="0 1.5707963267948966 0" xyz="0.1 0 0.005000000000000001"/>
  </joint>
  <link name="ultrasonic_rear_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 0.02 0.02"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 0.02 0.02"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.05"/>
      <inertia ixx="3.3333333333333337e-06" ixy="0.0" ixz="0.0" iyy="3.3333333333333337e-06" iyz="0.0" izz="3.3333333333333337e-06"/>
    </inertial>
  </link>
  <joint name="ultrasonic_rear_joint" type="fixed">
    <parent link="base_link"/>
    <child link="ultrasonic_rear_link"/>
    <origin rpy="0 -1.5707963267948966 0" xyz="-0.1 0 0.005000000000000001"/>
  </joint>
  <link name="ultrasonic_right_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 0.02 0.02"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 0.02 0.02"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.05"/>
      <inertia ixx="3.3333333333333337e-06" ixy="0.0" ixz="0.0" iyy="3.3333333333333337e-06" iyz="0.0" izz="3.3333333333333337e-06"/>
    </inertial>
  </link>
  <joint name="ultrasonic_right_joint" type="fixed">
    <parent link="base_link"/>
    <child link="ultrasonic_right_link"/>
    <origin rpy="0 0 -1.5707963267948966" xyz="0 -0.045 0.005000000000000001"/>
  </joint>
  <link name="ultrasonic_left_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 0.02 0.02"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <box size="0.02 0.02 0.02"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.05"/>
      <inertia ixx="3.3333333333333337e-06" ixy="0.0" ixz="0.0" iyy="3.3333333333333337e-06" iyz="0.0" izz="3.3333333333333337e-06"/>
    </inertial>
  </link>
  <joint name="ultrasonic_left_joint" type="fixed">
    <parent link="base_link"/>
    <child link="ultrasonic_left_link"/>
    <origin rpy="0 0 1.5707963267948966" xyz="0 0.045 0.005000000000000001"/>
  </joint>
  <!-- Colour -->
  <gazebo reference="base_link">
    <material>Gazebo/Green</material>
  </gazebo>
  <!-- Add materials for Gazebo -->
  <gazebo reference="camera_link">
    <material>Gazebo/Red</material>
  </gazebo>
  <gazebo reference="ultrasonic_front_link">
    <material>Gazebo/Blue</material>
  </gazebo>
  <gazebo reference="ultrasonic_rear_link">
    <material>Gazebo/Blue</material>
  </gazebo>
  <gazebo reference="ultrasonic_right_link">
    <material>Gazebo/Blue</material>
  </gazebo>
  <gazebo reference="ultrasonic_left_link">
    <material>Gazebo/Blue</material>
  </gazebo>
</robot>

-------------------- FILE: ./my_robot_gazebo/urdf/materials.xacro --------------------
<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

  <!-- Colour Definitions -->
  <material name="black">
    <color rgba="0.0 0.0 0.0 1.0"/>
  </material>

  <material name="blue">
    <color rgba="0.0 0.0 0.8 1.0"/>
  </material>

  <material name="green">
    <color rgba="0.0 0.8 0.0 1.0"/>
  </material>

  <material name="gray">
    <color rgba="0.753 0.753 0.753 1.0"/>
  </material>
  
  <material name="yellow">
    <color rgba="0.8 0.8 0 1"/>
  </material>

  <material name="orange">
    <color rgba="1.0 0.423529411765 0.0392156862745 1.0"/>
  </material>

  <material name="brown">
    <color rgba="0.870588235294 0.811764705882 0.764705882353 1.0"/>
  </material>

  <material name="red">
    <color rgba="0.8 0.0 0.0 1.0"/>
  </material>

  <material name="white">
    <color rgba="1.0 1.0 1.0 1.0"/>
  </material>

</robot>

-------------------- FILE: ./my_robot_gazebo/urdf/bicycle_bot.urdf.xacro --------------------
<?xml version="1.0"?>
<!--
  Robot model adapted from https://github.com/CIR-KIT/steer_drive_ros/blob/kinetic-devel/steer_drive_controller/test/common/urdf/steerbot.xacro

  Modifications:
    Remove base_footprint link. Useful for navigation but not necessary for a simple example.
    Added materials for URDF
    Updated inertials

  Geometry:
    The Ackermann steering controllers require the longitudinal
    separation between the front and back wheel axes and the
    lateral separation between the left and right front steering axes.
    
    For this model:
    wheel_separation_h = base_length - 2 * axle_offset = 0.4
    wheel_separation_w = base_width  + 2 * axle_offset = 0.4
-->
<robot name="bicycle_bot" xmlns:xacro="http://wiki.ros.org/xacro">
  <!-- Include xacro for inertials, materials and wheels -->
  <xacro:include filename="$(find steer_bot_description)/urdf/wheel.xacro"/>

  <xacro:property name="robot_namespace" value="/bicycle_bot"/>

  <!-- Gazebo plugins -->
  <gazebo>
    <!-- Load ros_control plugin -->
    <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">
      <robotNamespace>${robot_namespace}</robotNamespace>
      <robotSimType>gazebo_ros_control/DefaultRobotHWSim</robotSimType>
      <legacyModeNS>false</legacyModeNS>
    </plugin> 

    <!-- Load gazebo_ros plugin. Publish passive (non-actuated) joints from Gazebo -->
    <plugin name="gazebo_ros_joint_state_publisher" filename="libgazebo_ros_joint_state_publisher.so">
        <robotNamespace>${robot_namespace}</robotNamespace>
        <jointName>
            front_wheel_joint
        </jointName>
        <updateRate>50</updateRate>
        <alwaysOn>true</alwaysOn>
    </plugin>
  </gazebo>

  <!-- Math constants -->
  <xacro:property name="deg_to_rad" value="0.01745329251994329577"/>

  <!-- Robot base dimensions -->
  <xacro:property name="base_length" value="0.5" /> 
  <xacro:property name="base_width" value="0.12" /> 
  <xacro:property name="base_height" value="0.1" /> 
  <xacro:property name="base_mass" value="5" /> 

  <!-- Wheel link dimensions -->
  <xacro:property name="wheel_radius" value="0.1" />
  <xacro:property name="wheel_thickness" value="0.1" />
  <xacro:property name="wheel_mass" value="1" />

  <!-- Steering link dimensions -->
  <xacro:property name="steer_radius" value="0.05" />
  <xacro:property name="steer_thickness" value="0.02" />
  <xacro:property name="steer_mass" value="1" />

  <!-- Axle positions -->
  <xacro:property name="axle_offset" value="0.05" />
  <xacro:property name="steer_offset" value="0.02" />

  <!-- Base link -->
  <link name="base_link">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="${base_length} ${base_width} ${base_height}"/>
      </geometry>
      <material name="green" />
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="${base_length} ${base_width} ${base_height}"/>
      </geometry>
    </collision>
    <xacro:solid_cuboid_inertial 
        rpy="0 0 0" xyz="0 0 0"
        mass="${base_mass}"
        x="${base_length}" y="${base_width}" z="${base_height}" />
  </link>

  <!-- Front steer and rear wheel joints required for ackermann_steering_controller -->
  <xacro:front_steer
    name="front"
    parent="base"
    steer_radius="${steer_radius}"
    steer_thickness="${steer_thickness}" 
    steer_mass="${steer_mass}" 
    base_length="${base_length}"
    base_width="${base_width}"
    axle_offset="${axle_offset}"
    steer_height="${wheel_radius+steer_offset}">
  </xacro:front_steer>

  <xacro:front_wheel
    name="front"
    parent="front_steer"
    wheel_radius="${wheel_radius}"
    wheel_thickness="${wheel_thickness}"
    wheel_mass="${wheel_mass}">
    <origin xyz="0 0 ${-wheel_radius-steer_offset}" rpy="${-90 * deg_to_rad} 0 0"/>
  </xacro:front_wheel>

  <xacro:rear_wheel
    name="rear"
    parent="base"
    wheel_radius="${wheel_radius}"
    wheel_thickness="${wheel_thickness}"
    wheel_mass="${wheel_mass}">
    <origin xyz="${-base_length/2+axle_offset} 0 0" rpy="${-90 * deg_to_rad} 0 0"/>
  </xacro:rear_wheel>

  <!-- Colour -->
  <gazebo reference="base_link">
    <material>Gazebo/Green</material>
  </gazebo>

</robot>

-------------------- FILE: ./my_robot_gazebo/urdf/wheel.xacro --------------------
<?xml version="1.0"?>
<!--
  Robot model adapted from https://github.com/CIR-KIT/steer_drive_ros/blob/kinetic-devel/steer_drive_controller/test/common/urdf/wheel.xacro

  Modifications:
    STRICTLY RESTORED: Original geometry (origins, visual, collision) from ROS 1 version.
    Updated <transmissions> elements for ROS 2.
    Removed *origin param and insert_block from front_wheel_lr and rear_wheel_lr macros
    to use original hardcoded internal origins as intended by the ROS 1 design.
    FIXED: Missing closing </transmission> and </xacro:macro> tags.
    IMPROVED: Uncommented <collision> blocks for comprehensive physics simulation.
-->
<robot name="wheel" xmlns:xacro="http://wiki.ros.org/xacro">
  <!-- Include xacro for materials and inertials -->
  <xacro:include filename="materials.xacro"/>
  <xacro:include filename="inertials.xacro"/>

  <!-- Properties -->
  <xacro:property name="steer_effort" value="10.0"/>
  <xacro:property name="steer_velocity" value="5.0"/>
  <xacro:property name="steer_limit_deg" value="45.0"/>

  <!-- Bicycle model front steering link (required for steer_drive_controller) -->
  <xacro:macro name="front_steer"
    params="
      name
      parent
      steer_radius
      steer_thickness
      steer_mass
      base_length
      base_width
      axle_offset
      steer_height">
    <link name="${name}_steer_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="${steer_radius}" length="${steer_thickness}"/>
        </geometry>
        <material name="yellow" />
      </visual>
      <!-- <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="${steer_radius}" length="${steer_thickness}"/>
        </geometry>
      </collision> -->
      <xacro:solid_cylinder_inertial 
          rpy="0 0 0" xyz="0 0 0"
          mass="${steer_mass}"
          radius="${steer_radius}" length="${steer_thickness}" />
    </link>

    <joint name="${name}_steer_joint" type="revolute">
      <parent link="${parent}_link"/>
      <child link="${name}_steer_link"/>
      <origin xyz="${base_length/2-axle_offset} 0 ${steer_height}" rpy="0 0 0"/>
      <axis xyz="0 0 1"/>
      <limit effort="${steer_effort}"
             lower="${-180.0 * deg_to_rad}" upper="${180.0 * deg_to_rad}"
             velocity="${steer_velocity}"/>
    </joint>

    <transmission name="${name}_steer_joint_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <actuator name="${name}_steer_joint_motor">
        <mechanicalReduction>1</mechanicalReduction>
        <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      </actuator>
      <joint name="${name}_steer_joint">
        <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      </joint>
    </transmission>

    <gazebo reference="${name}_steer_link">
      <material>Gazebo/Yellow</material>
    </gazebo>
  </xacro:macro>

  <!-- Bicycle model rear wheel link (required for steer_drive_controller) -->
  <xacro:macro name="rear_wheel"
    params="
      name
      parent
      wheel_radius
      wheel_thickness
      wheel_mass
      *origin">
    <link name="${name}_wheel_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="${wheel_radius}" length="${wheel_thickness}"/>
        </geometry>
        <material name="yellow" />
      </visual>
      <!-- <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="${wheel_radius}" length="${wheel_thickness}"/>
        </geometry>
      </collision> -->
      <xacro:solid_cylinder_inertial 
          rpy="0 0 0" xyz="0 0 0"
          mass="${wheel_mass}"
          radius="${wheel_radius}" length="${wheel_thickness}" />
    </link>

    <joint name="${name}_wheel_joint" type="continuous">
      <parent link="${parent}_link"/>
      <child link="${name}_wheel_link"/>
      <xacro:insert_block name="origin"/>
      <axis xyz="0 0 1"/>
    </joint>

    <transmission name="${name}_wheel_joint_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <actuator name="${name}_wheel_joint_motor">
        <mechanicalReduction>1</mechanicalReduction>
        <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      </actuator>
      <joint name="${name}_wheel_joint">
        <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      </joint>
    </transmission>

    <gazebo reference="${name}_wheel_link">
      <material>Gazebo/Yellow</material>
    </gazebo>
  </xacro:macro>

  <!-- Car steering model front (steerable) wheel links (left/right) -->
  <xacro:macro name="front_wheel_lr"
    params="
      name
      parent
      reflect
      wheel_radius
      wheel_thickness
      wheel_mass
      steer_radius
      steer_thickness
      steer_mass
      base_length
      base_width
      axle_offset
      steer_height">
    <link name="${name}_steer_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="${steer_radius}" length="${steer_thickness}"/>
        </geometry>
        <material name="blue" />
      </visual>
      <!-- <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="${steer_radius}" length="${steer_thickness}"/>
        </geometry>
      </collision> -->
      <xacro:solid_cylinder_inertial 
          rpy="0 0 0" xyz="0 0 0"
          mass="${steer_mass}"
          radius="${steer_radius}" length="${steer_thickness}" />
    </link>

    <joint name="${name}_steer_joint" type="revolute">
      <parent link="${parent}_link"/>
      <child link="${name}_steer_link"/>
      <origin xyz="${base_length/2-axle_offset} ${reflect*(base_width/2+axle_offset)} ${steer_height}" rpy="0 0 0"/>
      <axis xyz="0 0 1"/>
      <limit effort="${steer_effort}"
             lower="${steer_limit_deg * deg_to_rad * -1.0}" upper="${steer_limit_deg * deg_to_rad}"
             velocity="${steer_velocity}"/>
    </joint>

    <link name="${name}_wheel_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="${wheel_radius}" length="${wheel_thickness}"/>
        </geometry>
        <material name="red" />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="${wheel_radius}" length="${wheel_thickness}"/>
        </geometry>
      </collision>
      <xacro:solid_cylinder_inertial 
          rpy="0 0 0" xyz="0 0 0"
          mass="${wheel_mass}"
          radius="${wheel_radius}" length="${wheel_thickness}" />
    </link>

    <joint name="${name}_wheel_joint" type="continuous">
      <parent link="${name}_steer_link"/>
      <child link="${name}_wheel_link"/>
      <origin xyz="0 0 ${-steer_height}" rpy="${-90 * deg_to_rad} 0 0"/>
      <axis xyz="0 0 1"/>
    </joint>

    <transmission name="${name}_steer_joint_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <actuator name="${name}_steer_joint_motor">
        <mechanicalReduction>1</mechanicalReduction>
        <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      </actuator>
      <joint name="${name}_steer_joint">
        <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      </joint>
    </transmission>

    <transmission name="${name}_wheel_joint_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <actuator name="${name}_wheel_joint_motor">
        <mechanicalReduction>1</mechanicalReduction>
        <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      </actuator>
      <joint name="${name}_wheel_joint">
        <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      </joint>
    </transmission>

    <gazebo reference="${name}_steer_link">
      <material>Gazebo/Blue</material>
    </gazebo>
    
    <gazebo reference="${name}_wheel_link">
      <material>Gazebo/Red</material>
    </gazebo>
  </xacro:macro>

  <!-- Car steering model rear wheel links (left/right) -->
  <xacro:macro name="rear_wheel_lr"
    params="
      name
      parent
      wheel_radius
      wheel_thickness
      wheel_mass
      *origin">
    <link name="${name}_wheel_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="${wheel_radius}" length="${wheel_thickness}"/>
        </geometry>
        <material name="red" />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="${wheel_radius}" length="${wheel_thickness}"/>
        </geometry>
      </collision>
      <xacro:solid_cylinder_inertial 
          rpy="0 0 0" xyz="0 0 0"
          mass="${wheel_mass}"
          radius="${wheel_radius}" length="${wheel_thickness}" />
    </link>

    <joint name="${name}_wheel_joint" type="continuous">
      <parent link="${parent}_link"/>
      <child link="${name}_wheel_link"/>
      <xacro:insert_block name="origin"/>
      <axis xyz="0 0 1"/>
    </joint>

    <transmission name="${name}_wheel_joint_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <actuator name="${name}_wheel_joint_motor">
        <mechanicalReduction>1</mechanicalReduction>
        <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      </actuator>
      <joint name="${name}_wheel_joint">
        <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      </joint>
    </transmission>

    <gazebo reference="${name}_wheel_link">
      <material>Gazebo/Red</material>
    </gazebo>
  </xacro:macro>
</robot>

-------------------- FILE: ./my_robot_gazebo/urdf/sensors.xacro --------------------
<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

  <!-- This macro creates an ultrasonic sensor link and joint -->
  <xacro:macro name="ultrasonic_sensor" params="prefix parent xyz rpy">
    <link name="ultrasonic_${prefix}_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <box size="${ultrasonic_length} ${ultrasonic_width} ${ultrasonic_height}"/>
        </geometry>
        <material name="grey"/>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <box size="${ultrasonic_length} ${ultrasonic_width} ${ultrasonic_height}"/>
        </geometry>
      </collision>
      <xacro:solid_cuboid_inertial
          rpy="0 0 0" xyz="0 0 0"
          mass="${ultrasonic_mass}"
          x="${ultrasonic_length}" y="${ultrasonic_width}" z="${ultrasonic_height}" />
    </link>

    <joint name="ultrasonic_${prefix}_joint" type="fixed">
      <parent link="${parent}"/>
      <child link="ultrasonic_${prefix}_link"/>
      <origin xyz="${xyz}" rpy="${rpy}"/>
    </joint>
  </xacro:macro>

</robot>

-------------------- FILE: ./my_robot_gazebo/urdf/inertials.xacro --------------------
<?xml version="1.0" ?>
<!--  xacro macros for inertials.

    Define xacro macros for math constants and inertials:
    
    - solid cuboid
    - solid cylinder
    - null (a placeholder inertial for logical link elements)
 -->
<robot name="inertials" xmlns:xacro="http://wiki.ros.org/xacro">

    <!-- Math constants -->
    <xacro:property name="math_pi"        value="3.141592653589793" />
    <xacro:property name="math_pi_over_2" value="1.5707963267948966" />
    <xacro:property name="math_pi_over_4" value="0.785398163397448" />

    <!-- Inertial for solid cuboid with dimensions x y z  -->
    <xacro:macro name="solid_cuboid_inertial" params="rpy xyz mass x y z">
        <inertial>
            <origin rpy="${rpy}" xyz="${xyz}"/>
            <mass value="${mass}" />
            <inertia
                ixx="${mass * (y * y + z * z) / 12.0}" ixy="0.0" ixz="0.0"
                iyy="${mass * (x * x + z * z) / 12.0}" iyz="0.0"
                izz="${mass * (x * x + y * y) / 12.0}" />
        </inertial>
    </xacro:macro>

    <!-- Inertial for solid cylinder with radius and length aligned to z-axis  -->
    <xacro:macro name="solid_cylinder_inertial" params="rpy xyz mass radius length">
        <inertial>
            <origin rpy="${rpy}" xyz="${xyz}"/>
            <mass value="${mass}" />
            <inertia
                ixx="${mass * (3.0 * radius * radius + length * length) / 12.0}" ixy="0.0" ixz="0.0"
                iyy="${mass * (3.0 * radius * radius + length * length) / 12.0}" iyz="0.0"
                izz="${mass * (radius * radius) / 2.0}" />
        </inertial>
    </xacro:macro>

    <!-- A null inertial - used in placeholder links to esure the model will work in Gazebo -->
    <xacro:macro name="null_inertial">
        <inertial>
            <mass value="0.001"/>
            <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
        </inertial>
    </xacro:macro>
</robot>
-------------------- FILE: ./my_robot_gazebo/urdf/steer_bot.urdf.xacro --------------------
<?xml version="1.0"?>
<robot name="steer_bot" xmlns:xacro="http://www.ros.org/wiki/xacro">
  <!-- Include xacro for wheels. wheel.xacro includes materials.xacro and inertials.xacro -->
  <xacro:include filename="wheel.xacro"/>

  <xacro:arg name="use_ros2_control" default="true"/>
  <xacro:property name="robot_namespace" value="/steer_bot"/>

  <!-- Math constants -->
  <xacro:property name="deg_to_rad" value="0.01745329251994329577"/>

  <!-- Robot base dimensions -->
  <xacro:property name="base_length" value="0.2" /> 
  <xacro:property name="base_width" value="0.09" /> 
  <xacro:property name="base_height" value="0.05" /> 
  <xacro:property name="base_mass" value="2.5" /> 

  <!-- Wheel link dimensions -->
  <xacro:property name="wheel_radius" value="0.034" />
  <xacro:property name="wheel_thickness" value="0.027" />
  <xacro:property name="wheel_mass" value="0.5" />

  <!-- Steering link dimensions -->
  <xacro:property name="steer_radius" value="0.05" />
  <xacro:property name="steer_thickness" value="0.02" />
  <xacro:property name="steer_mass" value="1" />

  <!-- Axle positions -->
  <xacro:property name="axle_offset" value="0.0125" />
  <xacro:property name="steer_offset" value="0.045" />

  <!-- Sensor dimensions -->
  <xacro:property name="ultrasonic_length" value="0.02" />
  <xacro:property name="ultrasonic_width" value="0.02" />
  <xacro:property name="ultrasonic_height" value="0.02" />
  <xacro:property name="ultrasonic_mass" value="0.05" />
  <xacro:property name="camera_size" value="0.03" />
  <xacro:property name="camera_mass" value="0.1" />

  <!-- SENSOR MACRO DEFINITION (No new file needed) -->
  <xacro:macro name="ultrasonic_sensor" params="prefix parent xyz rpy">
    <link name="ultrasonic_${prefix}_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <box size="${ultrasonic_length} ${ultrasonic_width} ${ultrasonic_height}"/>
        </geometry>
        <material name="gray"/>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <box size="${ultrasonic_length} ${ultrasonic_width} ${ultrasonic_height}"/>
        </geometry>
      </collision>
      <xacro:solid_cuboid_inertial
          rpy="0 0 0" xyz="0 0 0"
          mass="${ultrasonic_mass}"
          x="${ultrasonic_length}" y="${ultrasonic_width}" z="${ultrasonic_height}" />
    </link>
    <joint name="ultrasonic_${prefix}_joint" type="fixed">
      <parent link="${parent}"/>
      <child link="ultrasonic_${prefix}_link"/>
      <origin xyz="${xyz}" rpy="${rpy}"/>
    </joint>
  </xacro:macro>

  <!-- Base link -->
  <link name="base_link">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="${base_length} ${base_width} ${base_height}"/>
      </geometry>
      <material name="green" />
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="${base_length} ${base_width} ${base_height}"/>
      </geometry>
    </collision>
    <xacro:solid_cuboid_inertial 
        rpy="0 0 0" xyz="0 0 0"
        mass="${base_mass}"
        x="${base_length}" y="${base_width}" z="${base_height}" />
  </link>

  <!-- Steerable front wheels -->
  <xacro:front_wheel_lr 
    name="front_right" parent="base" reflect="-1"
    wheel_radius="${wheel_radius}" wheel_thickness="${wheel_thickness}" wheel_mass="${wheel_mass}" 
    steer_radius="${steer_radius}" steer_thickness="${steer_thickness}" steer_mass="${steer_mass}" 
    base_length="${base_length}" base_width="${base_width}" axle_offset="${axle_offset}"
    steer_height="${wheel_radius+steer_offset}" />
  <xacro:front_wheel_lr
    name="front_left" parent="base" reflect="1"
    wheel_radius="${wheel_radius}" wheel_thickness="${wheel_thickness}" wheel_mass="${wheel_mass}" 
    steer_radius="${steer_radius}" steer_thickness="${steer_thickness}" steer_mass="${steer_mass}" 
    base_length="${base_length}" base_width="${base_width}" axle_offset="${axle_offset}"
    steer_height="${wheel_radius+steer_offset}" />

  <!-- Rear wheels -->
  <xacro:rear_wheel_lr
    name="rear_right" parent="base"
    wheel_radius="${wheel_radius}" wheel_thickness="${wheel_thickness}" wheel_mass="${wheel_mass}">
    <origin xyz="${-base_length/2+axle_offset} ${-base_width/2-axle_offset} 0" rpy="${-90 * deg_to_rad} 0 0"/>
  </xacro:rear_wheel_lr>
  <xacro:rear_wheel_lr
    name="rear_left" parent="base"
    wheel_radius="${wheel_radius}" wheel_thickness="${wheel_thickness}" wheel_mass="${wheel_mass}">
    <origin xyz="${-base_length/2+axle_offset} ${+base_width/2+axle_offset} 0" rpy="${-90 * deg_to_rad} 0 0"/>
  </xacro:rear_wheel_lr>

  <!-- Camera Link -->
  <link name="camera_link">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <box size="${camera_size} ${camera_size} ${camera_size}" />
      </geometry>
      <material name="red" /> 
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <box size="${camera_size} ${camera_size} ${camera_size}" />
      </geometry>
    </collision>
    <xacro:solid_cuboid_inertial 
        rpy="0 0 0" xyz="0 0 0"
        mass="${camera_mass}"
        x="${camera_size}" y="${camera_size}" z="${camera_size}" />
  </link>

  <joint name="camera_joint" type="fixed">
    <parent link="base_link"/>
    <child link="camera_link"/>
    <origin xyz="${base_length/2} 0 ${base_height/2}" rpy="0 0 0"/>
  </joint>

  <!-- Ultrasonic Sensor Links -->
  <xacro:ultrasonic_sensor prefix="front" parent="base_link" xyz="${base_length/2} 0 ${base_height/2-ultrasonic_height}" rpy="0 ${90*deg_to_rad} 0" />
  <xacro:ultrasonic_sensor prefix="rear" parent="base_link" xyz="${-base_length/2} 0 ${base_height/2-ultrasonic_height}" rpy="0 ${-90*deg_to_rad} 0" />
  <xacro:ultrasonic_sensor prefix="right" parent="base_link" xyz="0 ${-base_width/2} ${base_height/2-ultrasonic_height}" rpy="0 0 ${-90*deg_to_rad}" />
  <xacro:ultrasonic_sensor prefix="left" parent="base_link" xyz="0 ${base_width/2} ${base_height/2-ultrasonic_height}" rpy="0 0 ${90*deg_to_rad}" />

  <!-- Gazebo Plugin for ros2_control -->
  <gazebo>
    <plugin filename="libgazebo_ros2_control.so" name="gazebo_ros2_control">
      <parameters>$(find my_robot_gazebo)/config/robot_controllers.yaml</parameters>
    </plugin>
  </gazebo>

  <!-- ros2_control hardware interface -->
  <ros2_control name="GazeboSystem" type="system">
    <hardware>
      <plugin>gazebo_ros2_control/GazeboSystem</plugin>
    </hardware>
    <joint name="front_left_steer_joint">
      <command_interface name="position"/>
      <state_interface name="position" />
      <state_interface name="velocity" />
    </joint>
    <joint name="front_right_steer_joint">
      <command_interface name="position"/>
      <state_interface name="position" />
      <state_interface name="velocity" />
    </joint>
    <joint name="rear_left_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position" />
      <state_interface name="velocity" />
    </joint>
    <joint name="rear_right_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position" />
      <state_interface name="velocity" />
    </joint>
  </ros2_control>

</robot>

-------------------- FILE: ./my_robot_gazebo/launch/my_robot_gazebo.launch.py --------------------
import os
import xacro
from ament_index_python.packages import get_package_share_directory
from launch import LaunchDescription
from launch.actions import DeclareLaunchArgument, ExecuteProcess
from launch.substitutions import LaunchConfiguration
from launch_ros.actions import Node

def generate_launch_description():

    # Get paths to required files
    pkg_share_path = get_package_share_directory('my_robot_gazebo')
    urdf_path = os.path.join(pkg_share_path, 'urdf', 'steer_bot.urdf.xacro')
    world_path = os.path.join(pkg_share_path, 'worlds', 'empty.world')

    # Process the URDF (Xacro) file
    robot_description_content = xacro.process_file(urdf_path).toprettyxml(indent='  ')
    
    # Declare a launch argument for use_sim_time
    use_sim_time = LaunchConfiguration('use_sim_time', default='true')

    # Launch Gazebo server and client
    gzserver = ExecuteProcess(
        cmd=['gzserver', '-s', 'libgazebo_ros_init.so', '-s', 'libgazebo_ros_factory.so', world_path],
        output='screen'
    )
    gzclient = ExecuteProcess(
        cmd=['gzclient'],
        output='screen'
    )

    # Robot State Publisher Node
    robot_state_publisher_node = Node(
        package='robot_state_publisher',
        executable='robot_state_publisher',
        output='screen',
        parameters=[{'use_sim_time': use_sim_time, 'robot_description': robot_description_content}]
    )

    # Spawn the robot entity in Gazebo
    spawn_entity_node = Node(
        package='gazebo_ros',
        executable='spawn_entity.py',
        arguments=['-topic', 'robot_description', '-entity', 'my_robot'],
        output='screen'
    )

    # ros2_control_node (Controller Manager) - this is what the spawners talk to
    ros2_control_node = Node(
        package='controller_manager',
        executable='ros2_control_node',
        parameters=[{'robot_description': robot_description_content, 'use_sim_time': use_sim_time}],
        output='screen'
    )

    # Joint State Broadcaster Spawner (CORRECTED)
    joint_state_broadcaster_spawner = Node(
        package='controller_manager',
        executable='spawner',
        arguments=['joint_state_broadcaster', '-c', 'controller_manager', '--controller-manager-timeout', '1000'],
        output='screen'
    )

    # Ackermann Steering Controller Spawner (CORRECTED)
    ackermann_steering_controller_spawner = Node(
        package='controller_manager',
        executable='spawner',
        arguments=['ackermann_steering_controller', '-c', 'controller_manager', '--controller-manager-timeout', '1000'],
        output='screen'
    )

    # Ros2 Policy Controller Node
    ros2_policy_controller = Node(
        package='my_robot_controller',
        executable='ros2_policy_controller',
        name='policy_controller_node',
        output='screen',
        parameters=[{'use_sim_time': use_sim_time}]
    )

    return LaunchDescription([
        DeclareLaunchArgument('use_sim_time', default_value='true', description='Use simulation (Gazebo) clock if true'),
        gzserver,
        gzclient,
        robot_state_publisher_node,
        spawn_entity_node,
        ros2_control_node,
        joint_state_broadcaster_spawner,
        ackermann_steering_controller_spawner,
        ros2_policy_controller
    ])

-------------------- FILE: ./my_robot_gazebo/worlds/my_robot.sdf --------------------
<?xml version="1.0" ?>
<sdf version="1.6">
  <world name="default">
    <include>
      <uri>model://ground_plane</uri>
    </include>
    <include>
      <uri>model://sun</uri>
    </include>
  </world>
</sdf>

-------------------- FILE: ./my_robot_gazebo/package.xml --------------------
<?xml version="1.0"?>
<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>
<package format="3">
  <name>my_robot_gazebo</name>
  <version>0.0.0</version>
  <description>A Gazebo package for the WRO robot model.</description>
  <maintainer email="user@todo.todo">user</maintainer>
  <license>TODO: License declaration</license>

  <buildtool_depend>ament_cmake</buildtool_depend>

  <!-- All dependencies needed for build and run time -->
  <depend>rclcpp</depend>
  <depend>gazebo_ros</depend>
  <depend>gazebo_ros2_control</depend>
  <depend>robot_state_publisher</depend>
  <depend>urdf</depend>
  <depend>xacro</depend>

  <test_depend>ament_lint_auto</test_depend>
  <test_depend>ament_lint_common</test_depend>

  <export>
    <build_type>ament_cmake</build_type>
  </export>
</package>

-------------------- FILE: ./codebase_snapshot.txt --------------------

